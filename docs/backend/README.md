## 进程和线程

- 进程是`资源分配`的基本单位
- 线程是`CPU调度`的基本单位
- 一个进程中最少包含一个线程
- 同一个进程内多个线程`共享内存`
- 在单核 CPU 上，根据`时间分片`策略，交替运行多个进程
- 在多核 CPU 上，可以同时运行多个进程

?>
[JS 编程、优化和面试不用愁，javascript 和浏览器运行机制，全面解读](https://mp.weixin.qq.com/s?__biz=MzIyMDgzNTUwMg==&mid=2247484064&idx=3&sn=2f526fbbeb145ae4a1c3419ffeb5ee26&chksm=97c4b961a0b33077ad49d34163061f3203a28b04515bbb5297c43ab5c72e02a028abae7d0ad7&scene=27)

## 进程之间通信的方式

- 管道（管道通信是单向传递信息的，如果要双向通信就要建立两个管道）
- 消息队列（写入和读取都需要拷贝）
- 共享内存（共用同一个物理地址）
- 信号量（解决多进程通信的读写冲突问题，保证内存的互斥访问和多个进程按顺序访问问题）（于共享内存一起使用）
- 信号（异步通信机制，进程内设立对应的监听事件，等待特殊信号触发）
- 套接字（socket，主要用于跨主机通信）

## 线程通信的方式

- 共享内存
- 消息传递

## 布隆（bloom）过滤器

- 布隆过滤器是一种`概率型`数据结构（ bit 二进制数组 + 多个 hash 函数映射关系实现）
- 用于判断一个元素`有可能存在或者一定不存在`集合中
- 可以`高效地插入和查询`，但是有误判的风险，相对于 map 存储，使用布隆过滤器更能节省`时间`和`空间`
- 使用场景：`redis 预防缓存穿透`

## 如何应对突然暴增的访问量

- 前端
  - `数据分片`处理，降低内存
  - `设置优先级`，根据优先级处理高优先级数据，低优先级数据延后处理
  - `数据压缩`，转换数据结构，使用 gzip 传输
  - 通过 `webworker 计算耗时`的请求，通过多线程来计算耗时任务
  - 使用`本地缓存 localstorage`，减少内存的使用
- 后端
  - `流量控制`
    - `限流`
      - 限制访问请求数量，降低吞吐量
      - 方式
        - 计数器
        - 令牌桶
        - 漏桶
    - `降级`
      - 保留部分功能可用，部分非核心功能暂时关闭
    - `熔断`
      - 停止服务一段时间
  - `redis 缓存`，减少实时计算和数据传输的负担。预计算和预加载可能被大量请求的数据，减轻瞬间数据暴增的压力
  - `消息队列`（MQ）转发数据，将大量消息暂存并分发到多个处理节点，分布式异步解耦的通信机制，类似一个订阅发布装置
  - `负载均衡`，将请求均匀分布到多个后端服务器，避免单点过载
  - `数据压缩`，对传输的数据进行压缩（如 Gzip、Deflate 等），减小网络传输量
  - `数据分片`，将数据分割成多个小块，逐块发送和接收，降低单次传输的负载，并在接收端实时处理数据流，避免一次性加载大量数据导致的内存压力
  - `异步处理`，采用多线程进行并行处理
  - `设置监控系统`，实时监控 CPU、内存、带宽、连接数、消息处理速率等关键指标，设置告警阀值、自动扩容等手段

## BFF 架构是什么

- BFF 架构是服务于前端的后端，是前端和后端之间的中间层，通过 BFF 来获取复杂的后端信息，然后聚合后端业务逻辑，产出更适合前端的接口
- 使用 BFF 架构，降低前端复杂度、解决数据组装和多端适配的问题，让服务器可以聚焦在业务处理上，数据展示交给 BFF 层去做
- 使用 BFF 层，一般通过 gRPC 远程调用来和各后端服务通信
- 应用场景
  - Serverless（云计算）
  - 云函数
  - API 网关
  - 云数据库
